<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>我的健康与训练仪表盘</title>
    <style>
        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', Roboto, 'Helvetica Neue', Arial, sans-serif;
            background-color: #f0f2f5;
            color: #333;
            margin: 0;
            padding: 20px;
        }
        h1 {
            text-align: center;
            color: #1a237e;
            margin-bottom: 40px;
        }
        .dashboard-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(450px, 1fr));
            gap: 25px;
            max-width: 1600px;
            margin: 0 auto;
        }
        .chart-container {
            background-color: #ffffff;
            padding: 25px;
            border-radius: 12px;
            box-shadow: 0 6px 20px rgba(0, 0, 0, 0.08);
            min-height: 400px; 
            display: flex;
            flex-direction: column;
        }
        .chart-container h2 {
            margin-top: 0;
            margin-bottom: 15px;
            font-size: 1.3em;
            color: #3f51b5;
        }
        .chart-header {
            display: flex;
            justify-content: center;
            align-items: center;
            position: relative;
            margin-bottom: 15px;
        }
        .chart-header h2 {
            margin: 0;
        }
        .toggle-button {
            position: absolute;
            right: 0;
            top: 50%;
            transform: translateY(-50%);
            background-color: #e8eaf6;
            color: #3f51b5;
            border: none;
            border-radius: 6px;
            padding: 6px 12px;
            font-size: 0.8em;
            cursor: pointer;
            transition: background-color 0.3s ease;
        }
        .toggle-button:hover {
            background-color: #c5cae9;
        }
        canvas {
            flex-grow: 1;
            max-height: 450px;
        }
    </style>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/chartjs-adapter-date-fns"></script>
</head>
<body>

    <h1>我的健康与训练仪表盘</h1>

    <div class="dashboard-grid">
        <div class="chart-container">
            <div class="chart-header">
                <h2 id="weightChartTitle">体重变化曲线（近半年）</h2>
                <button id="toggleWeightViewBtn" class="toggle-button">显示全部</button>
            </div>
            <canvas id="weightChart"></canvas>
        </div>
        
        <div class="chart-container">
            <div class="chart-header">
                <h2>静息心率</h2>
            </div>
            <canvas id="restingHeartRateChart"></canvas>
        </div>

        <div class="chart-container">
            <div class="chart-header">
                <h2>跑步综合分数</h2>
            </div>
            <canvas id="runningScoreChart"></canvas>
        </div>

        <div class="chart-container">
            <div class="chart-header">
                <h2>手臂 (Arms) 力量变化</h2>
            </div>
            <canvas id="armChart"></canvas>
        </div>

        <div class="chart-container">
            <div class="chart-header">
                <h2>胸 (Chest) 力量变化</h2>
            </div>
            <canvas id="chestChart"></canvas>
        </div>

        <div class="chart-container">
            <div class="chart-header">
                <h2>背 (Back) 力量变化</h2>
            </div>
            <canvas id="backChart"></canvas>
        </div>
        
        <div class="chart-container">
            <div class="chart-header">
                <h2>肩 (Shoulders) 力量变化</h2>
            </div>
            <canvas id="shoulderChart"></canvas>
        </div>

        <div class="chart-container">
            <div class="chart-header">
                <h2>腿 (Legs) 力量变化</h2>
            </div>
            <canvas id="legChart"></canvas>
        </div>
        
        <div class="chart-container">
            <div class="chart-header">
                <h2>核心 (Core) 力量变化</h2>
            </div>
            <canvas id="coreChart"></canvas>
        </div>
    </div>

    <script>
    // ##################################################################
    // #                     在这里更新您的个人数据                     #
    // ##################################################################

    // 1. 体重数据 (KG)
    const allWeightData = [
        { date: '2017-04-13', weight: 69.9 },
        { date: '2017-06-07', weight: 73.9 },
        { date: '2017-09-19', weight: 74.1 },
        { date: '2017-10-15', weight: 70.2 },
        { date: '2017-11-12', weight: 68.7 },
        { date: '2018-03-10', weight: 73.9 },
        { date: '2018-04-07', weight: 75.4 },
        { date: '2018-06-25', weight: 76.0 },
        { date: '2018-08-23', weight: 77.65},
        { date: '2018-10-22', weight: 78.2 },
        { date: '2018-12-03', weight: 79.0 },
        { date: '2019-01-04', weight: 80.9 },
        { date: '2019-03-04', weight: 77.85},
        { date: '2019-05-01', weight: 80.35},
        { date: '2019-07-01', weight: 81.65},
        { date: '2019-08-08', weight: 82.9 },
        { date: '2019-09-17', weight: 81.9 },
        { date: '2019-11-02', weight: 79.0 },
        { date: '2019-11-18', weight: 77.2 },
        { date: '2019-12-11', weight: 77.9 },
        { date: '2020-01-11', weight: 80.3 },
        { date: '2020-02-02', weight: 76.3 },
        { date: '2020-03-04', weight: 77.9 },
        { date: '2020-04-01', weight: 76.7 },
        { date: '2020-06-28', weight: 75.0 },
        { date: '2020-07-31', weight: 77.7 },
        { date: '2020-10-04', weight: 79.9 },
        { date: '2020-11-08', weight: 75.55},
        { date: '2021-06-15', weight: 85.0 },
        { date: '2022-03-26', weight: 82.0 },
        { date: '2022-06-26', weight: 75.0 },
        { date: '2022-09-26', weight: 80.0 },
        { date: '2022-12-26', weight: 85.0 },
        { date: '2025-05-15', weight: 86.0 }, 
        { date: '2025-06-15', weight: 83.0 },
        { date: '2025-07-15', weight: 81.0 }, 
        { date: '2025-08-26', weight: 79.0 }
    ];

    // 2. 静息心率数据 (bpm)
    const restingHeartRateData = [
        { date: '2025-05-15', value: 85 },
        { date: '2025-08-26', value: 75 }
    ];

    // 3. 跑步数据: { date, distance(miles), time(min), sprintTime(min) }
    const runningData = [
        { date: '2025-08-17', distance: 2.5, time: 30, sprintTime: 0 },
        { date: '2025-08-24', distance: 2.7, time: 35, sprintTime: 1.5 },
    ];
    
    // 4. 手臂数据 (lbs)
    const armData = [
        { 
            name: '靠墙二头弯举', 
            data: [
                { date: '2025-08-17', value: 10 },
                { date: '2025-08-24', value: 10 },
            ] 
        },
        { 
            name: '曲轴手掌后旋集中弯举', 
            data: [
                { date: '2025-08-17', value: 5 },
                { date: '2025-08-24', value: 7 },
            ] 
        },
        { 
            name: '杠铃臂屈伸', 
            data: [
                { date: '2025-08-17', value: 4.8 },
                { date: '2025-08-24', value: 6.8 },
            ] 
        },
        { 
            name: '钻石俯卧撑', 
            data: [
                { date: '2025-08-17', value: 0 },
                { date: '2025-08-24', value: 0 },
            ] 
        },
    ];

    // 5. 胸部数据 (lbs)
    const chestData = [
        { 
            name: '暂未开始', 
            data: [
                // { date: 'YYYY-MM-DD', value: 10 },
            ] 
        },
    ];

    // 6. 背部数据 (lbs)
    const backData = [
        { 
            name: '高位下拉', 
            data: [
                // { date: 'YYYY-MM-DD', value: 10 }, 
            ] 
        },
        { 
            name: '引体向上', 
            data: [
                { date: '2025-08-24', value: 0 },
            ] 
        },
    ];

    // 7. 肩部数据 (lbs)
    const shoulderData = [
        { 
            name: '哑铃侧平举', 
            data: [
                { date: '2025-08-22', value: 5 },
                { date: '2025-08-29', value: 5 },
            ] 
        },
        { 
            name: '坐姿哑铃推举', 
            data: [
                { date: '2025-08-22', value: 5 },
                { date: '2025-08-29', value: 9 },
            ] 
        },
    ];

    // 8. 腿部数据 (lbs)
    const legData = [
        { 
            name: '暂未开始', 
            data: [
                // { date: 'YYYY-MM-DD', value: 10 },
            ] 
        },
    ];
    
    // 9. 核心数据
    const coreData = [
        { 
            name: '平板支撑（单位：秒）', 
            data: [
                { date: '2025-08-26', value: 55 },
            ] 
        },
    ];

    // ##################################################################
    // #                 图表生成逻辑 (一般无需修改)                  #
    // ##################################################################

    // --- 跑步数据处理 ---
    const runningScoreData = runningData.map(run => {
        const timeHours = run.time / 60;
        const speedMph = timeHours > 0 ? run.distance / timeHours : 0;
        const sprintRatio = 1 + (run.sprintTime / run.time);
        const score = run.time * speedMph * sprintRatio;
        return { date: run.date, value: score };
    });

    // --- 图表初始化 ---
    document.addEventListener('DOMContentLoaded', () => {

        // 1. 生成体重图表 (含切换逻辑)
        const today = new Date('2025-08-26');
        const sixMonthsAgo = new Date(today);
        sixMonthsAgo.setMonth(today.getMonth() - 6);
        const recentWeightData = allWeightData.filter(d => new Date(d.date) >= sixMonthsAgo);
        
        const weightChartTitle = document.getElementById('weightChartTitle');
        const toggleWeightBtn = document.getElementById('toggleWeightViewBtn');
        let isShowingAllWeight = false;

        const weightChart = new Chart(document.getElementById('weightChart'), {
            type: 'line',
            data: { 
                datasets: [{ 
                    label: '体重 (KG)', 
                    data: recentWeightData, // 初始显示近半年数据
                    parsing: { xAxisKey: 'date', yAxisKey: 'weight' }, 
                    borderColor: 'rgb(75, 192, 192)', 
                    tension: 0.4, 
                    fill: true, 
                    backgroundColor: 'rgba(75, 192, 192, 0.2)' 
                }] 
            },
            options: { 
                scales: { 
                    x: { type: 'time', time: { unit: 'month' } }, 
                    y: { beginAtZero: false } 
                } 
            }
        });

        toggleWeightBtn.addEventListener('click', () => {
            isShowingAllWeight = !isShowingAllWeight;
            if (isShowingAllWeight) {
                // 更新为全部数据
                weightChart.data.datasets[0].data = allWeightData;
                weightChart.options.scales.x.time.unit = 'year'; // X轴单位改为年
                weightChartTitle.textContent = '全部体重变化曲线';
                toggleWeightBtn.textContent = '显示近半年';
            } else {
                // 更新为近半年数据
                weightChart.data.datasets[0].data = recentWeightData;
                weightChart.options.scales.x.time.unit = 'month'; // X轴单位改回月
                weightChartTitle.textContent = '体重变化曲线（近半年）';
                toggleWeightBtn.textContent = '显示全部';
            }
            weightChart.update(); // 重新渲染图表
        });
        
        // 2. 生成静息心率图表
        new Chart(document.getElementById('restingHeartRateChart'), {
            type: 'line',
            data: { datasets: [{ label: '静息心率 (bpm)', data: restingHeartRateData, parsing: { xAxisKey: 'date', yAxisKey: 'value' }, borderColor: 'rgb(255, 99, 132)', tension: 0.4, fill: true, backgroundColor: 'rgba(255, 99, 132, 0.2)' }] },
            options: { scales: { x: { type: 'time', time: { unit: 'month' } }, y: { beginAtZero: false, reverse: true } }, plugins: { tooltip: { callbacks: { label: (c) => `${c.dataset.label}: ${c.formattedValue} (越低越好)` } } } }
        });

        // 3. 生成跑步综合分数图表
        new Chart(document.getElementById('runningScoreChart'), {
            type: 'line',
            data: { datasets: [{ label: '跑步综合分数', data: runningScoreData, parsing: { xAxisKey: 'date', yAxisKey: 'value' }, borderColor: 'rgb(54, 162, 235)', tension: 0.4, fill: true, backgroundColor: 'rgba(54, 162, 235, 0.2)' }] },
            options: { scales: { x: { type: 'time', time: { unit: 'week' } }, y: { beginAtZero: true, title: { display: true, text: '分数 (越高越好)'} } }, plugins: { tooltip: { callbacks: { label: (c) => `分数: ${c.formattedValue.toFixed(2)}` } } } }
        });

        // 通用力/核心训练图表创建函数
        function createStrengthChart(canvasId, chartData, yAxisLabel) {
            const colors = ['#ff6384', '#36a2eb', '#cc65fe', '#ffce56'];
            const datasets = chartData.map((exercise, index) => ({
                label: exercise.name,
                data: exercise.data,
                borderColor: colors[index % colors.length],
                tension: 0.1,
                fill: false
            }));
            new Chart(document.getElementById(canvasId), {
                type: 'line',
                data: { datasets },
                options: { 
                    parsing: { xAxisKey: 'date', yAxisKey: 'value' }, 
                    scales: { 
                        x: { type: 'time', time: { unit: 'week' } }, 
                        y: { beginAtZero: false, title: { display: true, text: yAxisLabel } }
                    } 
                }
            });
        }
        
        // 4-9. 生成所有力量与核心训练图表
        createStrengthChart('armChart', armData, '重量 (lbs)');
        createStrengthChart('chestChart', chestData, '重量 (lbs)');
        createStrengthChart('backChart', backData, '重量 (lbs)');
        createStrengthChart('shoulderChart', shoulderData, '重量 (lbs)');
        createStrengthChart('legChart', legData, '重量 (lbs)');
        createStrengthChart('coreChart', coreData, '时长 (秒)');
    });
    </script>
</body>
</html>